---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const articles = await getCollection('aktuelles', ({ data }) => !data.draft);
const sorted = articles.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

function formatDate(dateStr: string) {
  return new Date(dateStr).toLocaleDateString('de-DE', { day: 'numeric', month: 'long', year: 'numeric' });
}
---
<BaseLayout title="Aktuelles & Impulse" description="Neuigkeiten, Fachbeiträge und wertvolle Impulse rund um Führung, Mitbestimmung und Konfliktmanagement.">
  <div class="max-w-6xl mx-auto px-4 py-16">
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-gray-900 mb-4">Aktuelles & Impulse</h1>
      <p class="text-gray-600 text-lg max-w-2xl mx-auto">Neuigkeiten, Fachbeiträge und wertvolle Impulse rund um Führung, Mitbestimmung und Konfliktmanagement.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {sorted.map(article => (
        <a href={`/aktuelles/${article.slug}`} class="group bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg hover:border-blue-200 transition-all duration-200">
          <div class="flex items-center gap-2 mb-3">
            <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-0.5 rounded-full">
              {article.data.category}
            </span>
            <span class="text-gray-400 text-xs">{formatDate(article.data.date)}</span>
          </div>
          <h2 class="text-lg font-bold text-gray-900 mb-2 group-hover:text-blue-700 transition leading-snug">
            {article.data.title}
          </h2>
          <p class="text-gray-500 text-sm leading-relaxed line-clamp-3">{article.data.description}</p>
          <div class="mt-4 text-blue-700 text-sm font-semibold group-hover:underline">Weiterlesen →</div>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
